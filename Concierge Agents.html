<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Smart Research Assistant</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @keyframes spin {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
    .animate-spin {
      animation: spin 1s linear infinite;
    }
  </style>
</head>
<body class="bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 min-h-screen">
  <div id="app"></div>

  <script>
    // Simple state management
    let state = {
      topic: '',
      depth: 'standard',
      isResearching: false,
      progress: '',
      report: null,
      sources: [],
      error: null
    };
 //  
    const ANTHROPIC_API_KEY = " YOUR_ANTHROPIC_KEY_HERE ";   // <==== ADD YOUR KEY HERE

    // Icons as SVG
    const icons = {
      bookOpen: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>',
      search: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>',
      loader: '<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="animate-spin"><line x1="12" y1="2" x2="12" y2="6"/><line x1="12" y1="18" x2="12" y2="22"/><line x1="4.93" y1="4.93" x2="7.76" y2="7.76"/><line x1="16.24" y1="16.24" x2="19.07" y2="19.07"/><line x1="2" y1="12" x2="6" y2="12"/><line x1="18" y1="12" x2="22" y2="12"/><line x1="4.93" y1="19.07" x2="7.76" y2="16.24"/><line x1="16.24" y1="7.76" x2="19.07" y2="4.93"/></svg>',
      fileText: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><line x1="10" y1="9" x2="8" y2="9"/></svg>',
      download: '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>',
      externalLink: '<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>',
      alert: '<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>'
    };

    // Conduct research function
    async function conductResearch() {
      if (!state.topic.trim()) {
        alert('Please enter a research topic');
        return;
      }

      state.isResearching = true;
      state.progress = 'Initializing research...';
      state.report = null;
      state.sources = [];
      state.error = null;
      render();

      try {
        // Step 1: Initial search
        state.progress = 'Searching the web for relevant sources...';
        render();
        
        console.log('Starting research for:', state.topic);
        
        const searchResponse = await fetch("https://api.anthropic.com/v1/messages", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "x-api-key": ANTHROPIC_API_KEY,
            "anthropic-version": "2023-06-01",
            "anthropic-dangerous-direct-browser-access": "true" 
          },
          body: JSON.stringify({
            model: "claude-3-5-sonnet-20240620", // Updated model name
            max_tokens: 4000,
            messages: [{
              role: "user",
              content: `You are a research assistant. Search the web for comprehensive information about: "${state.topic}". 

Focus on finding:
- Key facts and definitions
- Recent developments (2024-2025)
- Expert perspectives
- Statistical data
- Credible sources

Search broadly to get a good overview of this topic.`
            }]
          })
        });

        if (!searchResponse.ok) {
          throw new Error(`API Error: ${searchResponse.status} ${searchResponse.statusText}`);
        }

        const searchData = await searchResponse.json();
        console.log('Search response:', searchData);
        
        // Step 2: Deep analysis based on depth level
        state.progress = 'Analyzing sources and extracting key information...';
        render();
        
        const analysisPrompts = {
          quick: `Based on the search results, provide a concise 3-paragraph summary of "${state.topic}" covering the most important points.`,
          standard: `Based on the search results, create a comprehensive research report on "${state.topic}" with:
          
1. Executive Summary (2-3 sentences)
2. Key Findings (4-6 main points)
3. Detailed Analysis (2-3 paragraphs)
4. Current Trends & Developments
5. Conclusion

Keep it well-organized and informative.`,
          deep: `Based on the search results, create an in-depth research report on "${state.topic}" with:

1. Executive Summary
2. Background & Context
3. Comprehensive Key Findings (8-10 points)
4. Detailed Analysis (multiple paragraphs)
5. Current Trends, Developments & Future Outlook
6. Different Perspectives & Debates
7. Practical Applications/Implications
8. Conclusion & Recommendations

Be thorough and analytical.`
        };

        const conversationMessages = [];
        
        // Note: Real tool use handling would go here. Simplified for this demo.
        // We push the initial assistant response to history
        conversationMessages.push({ role: 'assistant', content: searchData.content });
        
        conversationMessages.push({
          role: 'user',
          content: analysisPrompts[state.depth]
        });

        const analysisResponse = await fetch("https://api.anthropic.com/v1/messages", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "x-api-key": ANTHROPIC_API_KEY,
            "anthropic-version": "2023-06-01",
            "anthropic-dangerous-direct-browser-access": "true"
          },
          body: JSON.stringify({
            model: "claude-3-5-sonnet-20240620",
            max_tokens: 4000,
            messages: conversationMessages
          })
        });

        if (!analysisResponse.ok) {
          throw new Error(`Analysis API Error: ${analysisResponse.status} ${analysisResponse.statusText}`);
        }

        const analysisData = await analysisResponse.json();
        console.log('Analysis response:', analysisData);
        
        state.progress = 'Compiling final report...';
        render();

        const reportText = analysisData.content
          .filter(c => c.type === 'text')
          .map(c => c.text)
          .join('\n\n');

        if (!reportText || reportText.trim().length === 0) {
          throw new Error('No report text generated. Please try again.');
        }

        const mockSources = [
          { title: `${state.topic} - Overview`, url: '#', type: 'Academic' },
          { title: `Latest Developments in ${state.topic}`, url: '#', type: 'News' },
          { title: `${state.topic} Research Papers`, url: '#', type: 'Research' },
          { title: `Expert Analysis: ${state.topic}`, url: '#', type: 'Expert Opinion' }
        ];

        state.report = reportText;
        state.sources = mockSources;
        state.progress = 'Research complete!';
        console.log('Research completed successfully');

      } catch (error) {
        console.error('Research error:', error);
        state.error = error.message || 'Error conducting research. Please try again.';
        state.progress = '';
      } finally {
        state.isResearching = false;
        render();
      }
    }

    function downloadReport() {
      const content = `RESEARCH REPORT: ${state.topic}\n${'='.repeat(50)}\n\n${state.report}\n\n\nSOURCES:\n${state.sources.map((s, i) => `${i + 1}. ${s.title} (${s.type})`).join('\n')}`;
      const blob = new Blob([content], { type: 'text/plain' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `research-${state.topic.replace(/\s+/g, '-').toLowerCase()}.txt`;
      a.click();
    }

    function render() {
      const app = document.getElementById('app');
      
      app.innerHTML = `
        <div class="max-w-5xl mx-auto p-4">
          
          <div class="text-center mb-8 pt-8">
            <div class="flex items-center justify-center mb-4 text-indigo-600">
               <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>
            </div>
            <h1 class="text-4xl font-bold text-gray-900 mb-2">
              Smart Research Assistant
            </h1>
            <p class="text-gray-600 text-lg">
              AI-powered research in minutes, not hours
            </p>
          </div>

          <div class="bg-white rounded-2xl shadow-xl p-8 mb-6">
            <div class="mb-6">
              <label class="block text-sm font-semibold text-gray-700 mb-2">
                What would you like to research?
              </label>
              <input
                type="text"
                id="topicInput"
                value="${state.topic}"
                placeholder="e.g., Quantum Computing, Climate Change Solutions, AI Ethics"
                class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-indigo-500 focus:outline-none text-lg"
              />
            </div>

            <div class="mb-6">
              <label class="block text-sm font-semibold text-gray-700 mb-2">
                Research Depth
              </label>
              <div class="grid grid-cols-3 gap-3">
                <button
                  onclick="setDepth('quick')"
                  class="px-4 py-3 rounded-lg border-2 transition ${state.depth === 'quick' ? 'border-indigo-500 bg-indigo-50 text-indigo-700' : 'border-gray-200 hover:border-gray-300'}"
                >
                  <div class="font-semibold">Quick</div>
                  <div class="text-xs text-gray-600">2-3 min</div>
                </button>
                <button
                  onclick="setDepth('standard')"
                  class="px-4 py-3 rounded-lg border-2 transition ${state.depth === 'standard' ? 'border-indigo-500 bg-indigo-50 text-indigo-700' : 'border-gray-200 hover:border-gray-300'}"
                >
                  <div class="font-semibold">Standard</div>
                  <div class="text-xs text-gray-600">5-7 min</div>
                </button>
                <button
                  onclick="setDepth('deep')"
                  class="px-4 py-3 rounded-lg border-2 transition ${state.depth === 'deep' ? 'border-indigo-500 bg-indigo-50 text-indigo-700' : 'border-gray-200 hover:border-gray-300'}"
                >
                  <div class="font-semibold">Deep Dive</div>
                  <div class="text-xs text-gray-600">10-15 min</div>
                </button>
              </div>
            </div>

            <button
              onclick="conductResearch()"
              ${state.isResearching ? 'disabled' : ''}
              class="w-full bg-indigo-600 text-white py-4 rounded-lg font-semibold text-lg hover:bg-indigo-700 transition disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center justify-center gap-2"
            >
              ${state.isResearching ? `
                ${icons.loader}
                <span>Researching...</span>
              ` : `
                ${icons.search}
                <span>Start Research</span>
              `}
            </button>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
            <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-100 hover:shadow-md transition duration-300">
              <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center text-blue-600 mb-4">
                ${icons.search}
              </div>
              <h3 class="font-bold text-lg text-gray-900 mb-2">Web Search Integration</h3>
              <p class="text-gray-600 text-sm">Automatically searches and analyzes multiple sources</p>
            </div>

            <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-100 hover:shadow-md transition duration-300">
              <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center text-purple-600 mb-4">
                ${icons.fileText}
              </div>
              <h3 class="font-bold text-lg text-gray-900 mb-2">Comprehensive Reports</h3>
              <p class="text-gray-600 text-sm">Generates structured, detailed research reports</p>
            </div>

            <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-100 hover:shadow-md transition duration-300">
              <div class="w-12 h-12 bg-indigo-100 rounded-lg flex items-center justify-center text-indigo-600 mb-4">
                ${icons.bookOpen}
              </div>
              <h3 class="font-bold text-lg text-gray-900 mb-2">Source Citations</h3>
              <p class="text-gray-600 text-sm">Tracks and cites all sources automatically</p>
            </div>
          </div>
          ${state.error ? `
            <div class="bg-red-50 border-2 border-red-200 rounded-xl p-6 mb-6">
              <div class="flex items-start gap-3 text-red-800">
                <div class="text-red-600">${icons.alert}</div>
                <div>
                  <div class="font-semibold mb-1">Error</div>
                  <div class="text-sm">${state.error}</div>
                  <div class="text-sm mt-2">Please check the browser console for more details.</div>
                </div>
              </div>
            </div>
          ` : ''}

          ${state.isResearching ? `
            <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
              <div class="flex items-center gap-3 text-indigo-600">
                ${icons.loader}
                <span class="font-medium">${state.progress}</span>
              </div>
            </div>
          ` : ''}

        </div>
      `;

      const topicInput = document.getElementById('topicInput');
      if (topicInput) {
        topicInput.addEventListener('input', (e) => {
          state.topic = e.target.value;
        });
        topicInput.addEventListener('keypress', (e) => {
          if (e.key === 'Enter') {
            conductResearch();
          }
        });
      }
    }

    function setDepth(depth) {
      state.depth = depth;
      render();
    }

    render();
  </script>
</body>
</html>